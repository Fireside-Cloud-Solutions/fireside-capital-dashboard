let tourActive=!1,currentTourStop=0;const TOUR_STOPS=[{target:"#sidebar",title:"Sidebar Navigation",description:"Navigate between different sections of your finances here.",position:"right"},{target:"#openAssetModalBtn",title:"Quick Actions",description:"Quickly add assets, bills, debts, and more from any page.",position:"bottom"},{target:"#netWorthValue",title:"Net Worth",description:"Your net worth is calculated automatically from your assets, debts, and investments.",position:"bottom"},{target:"#netWorthTimelineChart",title:"Financial Charts",description:"Track your financial progress over time with interactive charts.",position:"top"},{target:"#userDropdown",title:"User Menu",description:"Access settings and log out from here.",position:"bottom"}];function startFeatureTour(){tourActive=!0,currentTourStop=0,createTourOverlay(),showTourStop(0)}function nextTourStop(){currentTourStop++,currentTourStop>=TOUR_STOPS.length?finishTour():showTourStop(currentTourStop)}function skipTour(){tourActive=!1,removeTourElements(),"function"==typeof onboardingComplete&&onboardingComplete()}function finishTour(){tourActive=!1,removeTourElements(),currentUser&&sb.from("settings").upsert({user_id:currentUser.id,tour_completed:!0}).then(()=>{}).catch(t=>{}),"function"==typeof onboardingComplete&&onboardingComplete()}function createTourOverlay(){const t=document.createElement("div");t.id="tourOverlay",t.className="tour-overlay",document.body.appendChild(t)}function showTourStop(t){const o=document.getElementById("tourTooltip");o&&o.remove();const e=document.getElementById("tourSpotlight");e&&e.remove();const n=TOUR_STOPS[t],i=document.querySelector(n.target);if(!i)return void nextTourStop();highlightElement(i);const r=createTooltip(n,t);document.body.appendChild(r),positionTooltip(r,i,n.position)}function highlightElement(t){const o=document.createElement("div");o.id="tourSpotlight",o.className="tour-spotlight";const e=t.getBoundingClientRect();o.style.top=e.top+window.scrollY-8+"px",o.style.left=e.left+window.scrollX-8+"px",o.style.width=`${e.width+16}px`,o.style.height=`${e.height+16}px`,document.body.appendChild(o),t.scrollIntoView({behavior:"smooth",block:"center"})}function createTooltip(t,o){const e=document.createElement("div");e.id="tourTooltip",e.className="tour-tooltip";const n=o===TOUR_STOPS.length-1,i=`${o+1} of ${TOUR_STOPS.length}`;return e.innerHTML=`\n    <div class="tour-tooltip-header">\n      <h3 class="tour-tooltip-title">${escapeHtml(t.title)}</h3>\n      <span class="tour-tooltip-progress">${i}</span>\n    </div>\n    <p class="tour-tooltip-description">${escapeHtml(t.description)}</p>\n    <div class="tour-tooltip-actions">\n      ${n?"":'<button class="btn btn-sm btn-outline-secondary" data-action="skip-tour">Skip Tour</button>'}\n      <button class="btn btn-sm btn-primary" data-action="${n?"finish-tour":"next-tour-stop"}">\n        ${n?"Finish Tour":"Next"}\n      </button>\n    </div>\n  `,e}function positionTooltip(t,o,e){const n=o.getBoundingClientRect(),i=t.getBoundingClientRect();let r,s;switch(e){case"right":r=n.top+window.scrollY+n.height/2-i.height/2,s=n.right+window.scrollX+16;break;case"left":r=n.top+window.scrollY+n.height/2-i.height/2,s=n.left+window.scrollX-i.width-16;break;case"top":r=n.top+window.scrollY-i.height-16,s=n.left+window.scrollX+n.width/2-i.width/2;break;default:r=n.bottom+window.scrollY+16,s=n.left+window.scrollX+n.width/2-i.width/2}const c=window.innerWidth,l=window.innerHeight;s<10&&(s=10),s+i.width>c-10&&(s=c-i.width-10),r<10&&(r=10),r+i.height>window.scrollY+l-10&&(r=window.scrollY+l-i.height-10),t.style.top=`${r}px`,t.style.left=`${s}px`}function removeTourElements(){const t=document.getElementById("tourOverlay");t&&t.remove();const o=document.getElementById("tourTooltip");o&&o.remove();const e=document.getElementById("tourSpotlight");e&&e.remove()}document.addEventListener("click",function(t){const o=t.target.closest("[data-action]")?.dataset?.action;if(o)switch(o){case"skip-tour":skipTour();break;case"next-tour-stop":nextTourStop();break;case"finish-tour":finishTour()}});