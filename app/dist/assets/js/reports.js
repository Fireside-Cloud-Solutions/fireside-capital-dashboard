async function initReportsPage(){const t=await sb.auth.getUser();if(!t.data.user)return;const e=t.data.user.id;await loadReportSummary(e),await initializeReportCharts()}async function loadReportSummary(t){try{const{data:e,error:n}=await sb.from("snapshots").select("*").eq("user_id",t).order("date",{ascending:!1}).limit(1);if(n)throw n;if(e&&e.length>0){const t=e[0];document.getElementById("reportInvestments").textContent=formatCurrency(t.total_assets||0),document.getElementById("reportDebts").textContent=formatCurrency(t.total_debts||0);const n=document.getElementById("reportNetWorth"),o=t.net_worth||0;n.textContent=formatCurrency(o),n.className=o>=0?"text-success":"text-danger"}else document.getElementById("reportInvestments").textContent="$0.00",document.getElementById("reportDebts").textContent="$0.00",document.getElementById("reportNetWorth").textContent="$0.00"}catch(t){document.getElementById("reportInvestments").textContent="$0.00",document.getElementById("reportDebts").textContent="$0.00",document.getElementById("reportNetWorth").textContent="$0.00"}}async function initializeReportCharts(){try{document.getElementById("netWorthTimelineChart")&&"function"==typeof window.renderNetWorthChart&&(await window.renderNetWorthChart(),document.getElementById("netWorthSkeleton")?.classList.add("d-none")),document.getElementById("monthlyCashFlowChart")&&"function"==typeof window.generateMonthlyCashFlowChart&&(await window.generateMonthlyCashFlowChart(),document.getElementById("monthlyCashFlowSkeleton")?.classList.add("d-none")),document.getElementById("spendingCategoriesChart")&&"function"==typeof window.renderAdditionalCharts&&(await window.renderAdditionalCharts(),document.getElementById("spendingCategoriesSkeleton")?.classList.add("d-none"),document.getElementById("savingsRateSkeleton")?.classList.add("d-none"),document.getElementById("investmentGrowthSkeleton")?.classList.add("d-none"))}catch(t){}}function exportReportsData(){try{const t=document.getElementById("reportInvestments").textContent,e=document.getElementById("reportDebts").textContent,n=document.getElementById("reportNetWorth").textContent,o=(new Date).toISOString().split("T")[0],r=`Fireside Capital - Financial Report\nGenerated: ${o}\n\nMetric,Value\nTotal Investments,${t}\nTotal Debts,${e}\nNet Worth,${n}\n`,a=new Blob([r],{type:"text/csv;charset=utf-8;"}),d=window.URL.createObjectURL(a),s=document.createElement("a");s.href=d,s.download=`fireside-capital-report-${o}.csv`,document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(d)}catch(t){alert("Error exporting report. Please try again.")}}document.addEventListener("DOMContentLoaded",()=>{if(document.getElementById("reportInvestments")){initReportsPage();const t=document.querySelector(".page-header-actions button");t&&t.addEventListener("click",exportReportsData)}}),window.initReportsPage=initReportsPage,window.exportReportsData=exportReportsData;