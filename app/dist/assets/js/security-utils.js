function escapeHtml(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function sanitizeUserHTML(e){if(null==e)return"";let n=String(e);return n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),n=n.replace(/\son\w+\s*=\s*["'][^"']*["']/gi,""),n=n.replace(/\son\w+\s*=\s*[^\s>]*/gi,""),n=n.replace(/href\s*=\s*["']javascript:[^"']*["']/gi,'href="#"'),n=n.replace(/src\s*=\s*["']javascript:[^"']*["']/gi,'src=""'),n}function generateSecureToken(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}function initCSRFToken(){let e=sessionStorage.getItem("csrfToken");return e||(e=generateSecureToken(),sessionStorage.setItem("csrfToken",e)),e}function getCSRFToken(){return sessionStorage.getItem("csrfToken")}function addCSRFHeader(e={}){const n=getCSRFToken();return n&&(e["X-CSRF-Token"]=n),e}"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",()=>{initCSRFToken()}),"undefined"!=typeof module&&module.exports&&(module.exports={escapeHtml:escapeHtml,sanitizeUserHTML:sanitizeUserHTML,generateSecureToken:generateSecureToken,initCSRFToken:initCSRFToken,getCSRFToken:getCSRFToken,addCSRFHeader:addCSRFHeader}),window.SecurityUtils={escapeHtml:escapeHtml,sanitizeUserHTML:sanitizeUserHTML,generateSecureToken:generateSecureToken,initCSRFToken:initCSRFToken,getCSRFToken:getCSRFToken,addCSRFHeader:addCSRFHeader};