class RateLimiter{constructor(e,t){this.maxRequests=e,this.windowMs=t,this.requests=new Map}allow(e){const t=Date.now();this.requests.has(e)||this.requests.set(e,[]);const i=this.requests.get(e).filter(e=>e>t-this.windowMs);return this.requests.set(e,i),!(i.length>=this.maxRequests||(i.push(t),0))}getRemainingTime(e){if(!this.requests.has(e))return 0;const t=Date.now(),i=this.requests.get(e).filter(e=>e>t-this.windowMs);if(i.length<this.maxRequests)return 0;const s=Math.min(...i);return Math.max(0,this.windowMs-(t-s))}reset(e){this.requests.delete(e)}resetAll(){this.requests.clear()}}const rateLimiters={save:new RateLimiter(5,1e4),delete:new RateLimiter(3,1e4),search:new RateLimiter(10,1e4),report:new RateLimiter(2,6e4),plaid:new RateLimiter(3,3e4),email:new RateLimiter(2,6e4),general:new RateLimiter(20,1e4)};function disableButtonTemporarily(e,t,i){if(!e)return;e.disabled=!0,e.classList.add("disabled");const s=e.innerHTML;if(t>2e3){let n=Math.ceil(t/1e3);const a=setInterval(()=>{n--,n>0&&(e.innerHTML=`<i class="bi bi-hourglass-split"></i> Wait ${n}s`)},1e3);setTimeout(()=>{clearInterval(a),e.disabled=!1,e.classList.remove("disabled"),e.innerHTML=i||s},t)}else setTimeout(()=>{e.disabled=!1,e.classList.remove("disabled"),e.innerHTML=i||s},t)}function withRateLimit(e,t,i="action",s=null){const n=rateLimiters[e]||rateLimiters.general;if(!n.allow(i)){const e=n.getRemainingTime(i),t=Math.ceil(e/1e3),a=document.createElement("div");return a.className="alert alert-warning alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3",a.style.zIndex="9999",a.style.maxWidth="500px",a.innerHTML=`\n      <i class="bi bi-exclamation-triangle-fill me-2"></i>\n      <strong>Slow down!</strong> Too many ${i} requests. Please wait ${t} seconds.\n      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n    `,document.body.appendChild(a),setTimeout(()=>{a.remove()},3e3),s&&disableButtonTemporarily(s,e,s.innerHTML),!1}try{return t()}catch(e){throw e}}"undefined"!=typeof window&&(window.RateLimiter=RateLimiter,window.rateLimiters=rateLimiters,window.withRateLimit=withRateLimit,window.disableButtonTemporarily=disableButtonTemporarily);