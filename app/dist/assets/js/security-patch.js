!function(){if("undefined"==typeof CSRF)return;["saveAsset","deleteAsset","saveInvestment","deleteInvestment","saveDebt","deleteDebt","saveBill","deleteBill","saveIncome","deleteIncome","saveSettings","saveBudgetAssignment","saveBudgetItem","removeBudgetItem","shareBill","approveBill","rejectBill"].forEach(e=>{if("function"==typeof window[e]){const t=window[e];window[e]=async function(...e){try{return CSRF.requireValidToken(),await t.apply(this,e)}catch(e){if(e.message.includes("CSRF"))return void("function"==typeof showToast?showToast("Security validation failed. Please refresh the page and try again.","danger"):alert("Security validation failed. Please refresh the page and try again."));throw e}}}});const e=window.fetch;function t(){document.cookie.split(";").some(e=>{const[t]=e.trim().split("=");return t.startsWith("sb-")&&!e.includes("Secure")&&"https:"===location.protocol})&&location.protocol}window.fetch=function(...t){const[n,o={}]=t,s=(o.method||"GET").toUpperCase();if(["POST","PUT","DELETE","PATCH"].includes(s)){const e=CSRF.getToken();e&&(o.headers=o.headers||{},o.headers instanceof Headers?o.headers.set("X-CSRF-Token",e):o.headers["X-CSRF-Token"]=e)}return e.apply(this,[n,o])},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}();