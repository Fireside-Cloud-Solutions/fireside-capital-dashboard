<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS & Input Validation Test Suite</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #f44e24;
            padding-bottom: 10px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-left: 4px solid #01a4ef;
        }
        .test-section h3 {
            color: #01a4ef;
            margin-top: 0;
        }
        .payload {
            background: #2d2d2d;
            color: #00ff00;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        .result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .result.pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .result.fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .result.pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        button {
            background: #f44e24;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #d43d1a;
        }
        button.secondary {
            background: #01a4ef;
        }
        button.secondary:hover {
            background: #0189cc;
        }
        #testResults {
            margin-top: 30px;
        }
        .instruction {
            background: #e7f3ff;
            padding: 15px;
            border-left: 4px solid #01a4ef;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #01a4ef;
            color: white;
        }
        tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîí Fireside Capital - XSS & Input Validation Test Suite</h1>
        
        <div class="instruction">
            <strong>‚ö†Ô∏è Instructions:</strong>
            <ol>
                <li>Open the Fireside Capital app in another browser tab</li>
                <li>Login with test account (Matt or Brittany)</li>
                <li>Click test buttons below to copy payloads</li>
                <li>Paste payloads into app form fields and submit</li>
                <li>Document results in this page</li>
            </ol>
        </div>

        <!-- XSS Payloads -->
        <div class="test-section">
            <h3>üéØ XSS Test Payloads</h3>
            <p>Test these payloads in: Bill Name, Asset Name, Budget Item, Display Name, etc.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Payload</th>
                        <th>Type</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="xssPayloads"></tbody>
            </table>
        </div>

        <!-- SQL Injection Payloads -->
        <div class="test-section">
            <h3>üíâ SQL Injection Test Payloads</h3>
            <p>Test in: Login form, Search fields, Text inputs</p>
            
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Payload</th>
                        <th>Expected Target</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="sqlPayloads"></tbody>
            </table>
        </div>

        <!-- Business Logic Tests -->
        <div class="test-section">
            <h3>üßÆ Business Logic Test Cases</h3>
            
            <h4>Negative/Invalid Amounts</h4>
            <div id="amountTests">
                <div class="payload">Test: Create bill with amount = -$1000.00</div>
                <div class="payload">Test: Create asset with value = $0</div>
                <div class="payload">Test: Create debt with balance = -$500</div>
                <div class="payload">Test: Create investment with contribution = $999999999999</div>
            </div>
            
            <h4>Date Manipulation</h4>
            <div id="dateTests">
                <div class="payload">Test: Set next_due_date = 9999-12-31</div>
                <div class="payload">Test: Set next_due_date = 1900-01-01</div>
                <div class="payload">Test: Set next_due_date = "invalid-date"</div>
            </div>
            
            <h4>Shared Bill Exploits</h4>
            <div id="sharedBillTests">
                <div class="payload">Test: Set owner_percent = 60%, shared_percent = 60% (sum = 120%)</div>
                <div class="payload">Test: Share bill with non-connected user</div>
                <div class="payload">Test: Delete bill as shared user (non-owner)</div>
                <div class="payload">Test: Modify split percentage after acceptance</div>
            </div>
        </div>

        <!-- Test Results Log -->
        <div class="test-section">
            <h3>üìä Test Results Log</h3>
            <button onclick="exportResults()">Export Results as JSON</button>
            <button class="secondary" onclick="clearResults()">Clear Results</button>
            
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        const xssPayloads = [
            { payload: '<script>alert("XSS")</script>', type: 'Basic Script' },
            { payload: '<img src=x onerror=alert("XSS")>', type: 'Image Error' },
            { payload: '<svg onload=alert("XSS")>', type: 'SVG Onload' },
            { payload: 'javascript:alert("XSS")', type: 'JavaScript Protocol' },
            { payload: '<iframe src=javascript:alert("XSS")>', type: 'Iframe JavaScript' },
            { payload: '"><script>alert(String.fromCharCode(88,83,83))</script>', type: 'Encoded Script' },
            { payload: '<body onload=alert("XSS")>', type: 'Body Onload' },
            { payload: '<input onfocus=alert("XSS") autofocus>', type: 'Input Autofocus' },
            { payload: '<marquee onstart=alert("XSS")>', type: 'Marquee Event' },
            { payload: '<h1 style="color:red" onclick=alert("XSS")>TEST</h1>', type: 'Styled Element' }
        ];

        const sqlPayloads = [
            { payload: '\' OR \'1\'=\'1', target: 'Login / Search' },
            { payload: '\' OR 1=1--', target: 'Login' },
            { payload: '\'; DROP TABLE bills--', target: 'Any Text Field' },
            { payload: '\' UNION SELECT null,null,null--', target: 'Search' },
            { payload: 'admin\'--', target: 'Email Field' },
            { payload: '\' OR \'a\'=\'a', target: 'Login / Filter' },
            { payload: '1\'; DELETE FROM users WHERE \'1\'=\'1', target: 'Numeric Field' },
            { payload: '\' OR EXISTS(SELECT * FROM auth.users)--', target: 'Any Field' }
        ];

        let testResults = [];

        function loadPayloads() {
            const xssTable = document.getElementById('xssPayloads');
            xssPayloads.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><code>${escapeHtml(item.payload)}</code></td>
                    <td>${item.type}</td>
                    <td>
                        <button onclick="copyPayload('${escapeJs(item.payload)}', 'XSS-${index + 1}')">üìã Copy</button>
                        <button class="secondary" onclick="logResult('XSS-${index + 1}', 'PASS')">‚úÖ Pass</button>
                        <button style="background:#dc3545" onclick="logResult('XSS-${index + 1}', 'FAIL')">‚ùå Fail</button>
                    </td>
                `;
                xssTable.appendChild(row);
            });

            const sqlTable = document.getElementById('sqlPayloads');
            sqlPayloads.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td><code>${escapeHtml(item.payload)}</code></td>
                    <td>${item.target}</td>
                    <td>
                        <button onclick="copyPayload('${escapeJs(item.payload)}', 'SQL-${index + 1}')">üìã Copy</button>
                        <button class="secondary" onclick="logResult('SQL-${index + 1}', 'PASS')">‚úÖ Pass</button>
                        <button style="background:#dc3545" onclick="logResult('SQL-${index + 1}', 'FAIL')">‚ùå Fail</button>
                    </td>
                `;
                sqlTable.appendChild(row);
            });
        }

        function copyPayload(payload, testId) {
            navigator.clipboard.writeText(payload).then(() => {
                alert(`Payload copied! Test ID: ${testId}\n\nNow paste this into the Fireside Capital app and observe behavior.`);
            });
        }

        function logResult(testId, status) {
            const notes = prompt(`Test ${testId} - ${status}\n\nEnter notes (optional):`);
            
            const result = {
                testId,
                status,
                notes: notes || 'No notes',
                timestamp: new Date().toISOString()
            };
            
            testResults.push(result);
            displayResults();
        }

        function displayResults() {
            const container = document.getElementById('testResults');
            if (testResults.length === 0) {
                container.innerHTML = '<p style="color:#666;font-style:italic;">No test results yet. Run tests and log results above.</p>';
                return;
            }

            let html = '<table><thead><tr><th>Test ID</th><th>Status</th><th>Notes</th><th>Time</th></tr></thead><tbody>';
            
            testResults.forEach(result => {
                const statusClass = result.status === 'PASS' ? 'pass' : 'fail';
                const statusEmoji = result.status === 'PASS' ? '‚úÖ' : '‚ùå';
                html += `
                    <tr class="${statusClass}">
                        <td><strong>${result.testId}</strong></td>
                        <td>${statusEmoji} ${result.status}</td>
                        <td>${escapeHtml(result.notes)}</td>
                        <td>${new Date(result.timestamp).toLocaleTimeString()}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            
            const summary = {
                total: testResults.length,
                passed: testResults.filter(r => r.status === 'PASS').length,
                failed: testResults.filter(r => r.status === 'FAIL').length
            };
            
            html = `
                <div style="background:#e7f3ff;padding:15px;border-radius:4px;margin-bottom:20px;">
                    <strong>Summary:</strong> ${summary.total} tests | 
                    <span style="color:green">${summary.passed} passed</span> | 
                    <span style="color:red">${summary.failed} failed</span>
                </div>
            ` + html;
            
            container.innerHTML = html;
        }

        function exportResults() {
            if (testResults.length === 0) {
                alert('No results to export yet.');
                return;
            }

            const data = {
                testSuite: 'Input Validation & XSS',
                application: 'Fireside Capital',
                timestamp: new Date().toISOString(),
                results: testResults
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `pentest-results-${Date.now()}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function clearResults() {
            if (confirm('Clear all test results?')) {
                testResults = [];
                displayResults();
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function escapeJs(text) {
            return text.replace(/'/g, "\\'").replace(/"/g, '\\"');
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            loadPayloads();
            displayResults();
        });
    </script>
</body>
</html>
